---
import ContactModal from "../ContactModal.astro";
import { projects } from "@/data/projects";
import Button from "@/components/ui/Button.astro";
import Chip from "@/components/ui/Chip.astro";
import Card from "@/components/ui/Card.astro";
import Container from "@/components/ui/Container.astro";
import ProjectGrid from "@/components/ui/ProjectGrid.astro";
import ProjectCard from "@/components/ui/ProjectCard.astro";

const heroChips: { label: string; key: string }[] = [
    { label: "Backend", key: "chip.backend" },
    { label: "Islas Canarias", key: "chip.canary" },
    { label: "Remoto", key: "chip.remote" },
    { label: "Estudiante de informatica", key: "chip.csStudent" },
    { label: "Ingles / Espanol", key: "chip.bilingual" },
];

const featuredProjects = projects.slice(0, 3);
---

<div class="layout">
    <Container as="aside" aria-label="Información personal">
        <div class="avatar-ctn">
            <img
                class="avatar"
                src="/img/foto-yo.png"
                alt="Foto de Miguel Santiesteban"
            />
        </div>

        <Card>
            <h2 class="visually-hidden">Especialidades</h2>
            <div role="list" aria-label="Especialidades y ubicación" style="display: contents;">
                {heroChips.map((chip) => (
                    <Chip data-i18n-key={chip.key} role="listitem">
                        {chip.label}
                    </Chip>
                ))}
            </div>
        </Card>
    </Container>

    <Container>
        <Card
            title="Sobre mi"
            titleKey="about.title"
            titleId="about-heading"
        >
            <p class="about-description" data-i18n-key="about.description">
                Soy Miguel Santiesteban, un estudiante de Ingenieria
                Informatica de 22 anos de las Islas Canarias, Espana. Me
                especializo en desarrollo backend y disfruto crear proyectos
                desde cero, resolver problemas complejos y aprender de forma
                continua.
            </p>
            <div class="btn-ctn">
                <Button
                    href="/cv-miguel-santiesteban-aguiar-esp.pdf"
                    download
                    data-i18n-key="about.downloadCv"
                    data-i18n-attr-href="about.downloadCv.href"
                >
                    Descargar CV
                </Button>
                <Button
                    variant="rainbow"
                    type="button"
                    data-contact-modal-trigger
                    aria-label="Abrir formulario de contacto"
                    data-i18n-key="about.contact"
                    data-i18n-attr-aria-label="contact.modal.open"
                >
                    Contacto
                </Button>
            </div>
        </Card>

        <Card
            title="Tecnologias"
            titleKey="about.stack"
            titleId="stack-heading"
        >
            <div role="list" aria-label="Tecnologías que manejo" style="display: contents;">
                <Chip role="listitem">TypeScript</Chip>
                <Chip role="listitem">Node.js</Chip>
                <Chip role="listitem">NestJS</Chip>
                <Chip role="listitem">Prisma</Chip>
                <Chip role="listitem">MySQL</Chip>
                <Chip role="listitem">React</Chip>
                <Chip role="listitem">Docker</Chip>
                <Chip role="listitem">GraphQL</Chip>
                <Chip role="listitem">Astro</Chip>
                <Chip role="listitem">Redis</Chip>
            </div>
        </Card>

        <Card
            title="Proyectos destacados"
            titleKey="about.topProjects"
            titleId="featured-heading"
            class="card-fill"
        >
            <ProjectGrid>
                {featuredProjects.map((project) => (
                    <ProjectCard {...project} />
                ))}
            </ProjectGrid>
        </Card>
    </Container>
</div>

<ContactModal />

<style>
    .about-description {
        padding-left: var(--space-xs);
        line-height: 1.6;
    }

    .card-fill {
        flex: 1;
    }

    .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }

    .btn-ctn {
        display: flex;
        justify-content: center;
        align-items: end;
        gap: var(--space-sm);
        padding: 0;
    }

    .avatar-ctn {
        display: flex;
        justify-content: center;
        align-items: end;
        flex: 1 1 auto;
        min-height: 0;
        padding: 0;
    }

    .avatar {
        width: auto;
        max-height: 100%;
        object-fit: contain;
        padding: 0;
        -webkit-mask-image: linear-gradient(to bottom, #000 0%, #000 75%, transparent 100%);
        mask-image: linear-gradient(to bottom, #000 0%, #000 75%, transparent 100%);
    }

    /* Responsive */
    @media (min-width: 1200px) {
        .about-description {
            font-size: 1rem;
        }
    }

    @media (min-width: 900px) and (max-width: 1199px) {
        .about-description {
            font-size: 0.95rem;
        }
    }

    @media (min-width: 640px) and (max-width: 899px) {
        .about-description {
            font-size: 0.9rem;
        }
    }

    @media (max-width: 639px) {
        .about-description {
            font-size: 0.7rem;
        }
    }
</style>
