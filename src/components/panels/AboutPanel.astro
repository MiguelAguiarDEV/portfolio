<div class="layout">
    <!-- Izquierda -->
    <aside class="col-left column pad stack">
        <div class="avatar-card">
            <div class="avatar-wrap">
                <img
                    class="avatar"
                    src="/img/foto-yo.png"
                    alt="Foto de Miguel Santiesteban"
                />
            </div>
        </div>

        <div class="info-left">
            <div class="chips cluster card pad">
                <span class="chip">Backend</span>
                <span class="chip">Canary Islands</span>
                <span class="chip">Remote</span>
                <span class="chip">CS student</span>
                <span class="chip">English / Spanish</span>
            </div>
        </div>
    </aside>

    <!-- Derecha -->
    <section class="col-right column pad stack">
        <!-- About -->
        <div class="section stack">
            <h3>About me</h3>
            <div class="card pad stack">
                <p class="prose">
                    I’m Miguel Santiesteban, a 22-year-old Computer Science
                    student from the Canary Islands, Spain. I specialize in
                    backend development and love building projects from the
                    ground up, solving hard problems, and learning continuously.
                </p>
                <div class="cta">
                    <a
                        class="btn"
                        href="/cv/Miguel_Santiesteban_CV.pdf"
                        download>Download CV</a
                    >
                    <a
                        class="btn"
                        href="mailto:miguel@example.com?subject=Contacto%20—%20Miguel%20Santiesteban"
                        >Contact</a
                    >
                </div>
            </div>
        </div>

        <!-- Stack -->
        <div class="section stack">
            <h3>Stack</h3>
            <div class="chips cluster card pad">
                <span class="chip">TypeScript</span>
                <span class="chip">Node.js</span>
                <span class="chip">NestJS</span>
                <span class="chip">Prisma</span>
                <span class="chip">MySQL</span>
                <span class="chip">React</span>
                <span class="chip">Docker</span>
                <span class="chip">Docker</span>
                <span class="chip">Docker</span>
                <span class="chip">Docker</span>
            </div>
        </div>

        <!-- Top projects -->
        <div class="section stack fill">
            <h3>Top projects</h3>
            <div class="projects card pad">
                <!-- Project 1 -->
                <article class="project">
                    <div class="carousel">
                        <div class="slides">
                            <figure>
                                <img
                                    loading="lazy"
                                    src="/img/projects/p1-1.jpg"
                                    alt="Vista 1"
                                />
                            </figure>
                            <figure>
                                <img
                                    loading="lazy"
                                    src="/img/projects/p1-2.jpg"
                                    alt="Vista 2"
                                />
                            </figure>
                            <figure>
                                <video
                                    preload="none"
                                    controls
                                    playsinline
                                    muted
                                    poster="/img/projects/p1-cover.jpg"
                                >
                                    <source
                                        src="/video/projects/p1-demo.mp4"
                                        type="video/mp4"
                                    />
                                    Tu navegador no soporta video.
                                </video>
                            </figure>
                        </div>
                        <div class="car-ctrl">
                            <button class="arrow left" aria-label="Anterior"
                                >‹</button
                            >
                            <button class="arrow right" aria-label="Siguiente"
                                >›</button
                            >
                            <div class="dots">
                                <i class="dot is-active"></i><i class="dot"
                                ></i><i class="dot"></i>
                            </div>
                        </div>
                    </div>
                    <div class="p-meta">
                        <h4>[Nombre del proyecto]</h4>
                        <p class="prose">
                            [Descripción breve. Qué resuelve, rol, impacto.]
                        </p>
                        <div class="p-tags">
                            <span class="chip">[Stack 1]</span><span
                                class="chip">[Stack 2]</span
                            ><span class="chip">[Stack 3]</span>
                        </div>
                        <div class="p-links">
                            <a class="btn" href="#">Live</a>
                            <a class="btn" href="#">Repo</a>
                        </div>
                    </div>
                </article>

                <!-- Project 2 -->
                <article class="project">
                    <div class="carousel">
                        <div class="slides">
                            <figure>
                                <img
                                    loading="lazy"
                                    src="/img/projects/p2-1.jpg"
                                    alt="Vista 1"
                                />
                            </figure>
                            <figure>
                                <img
                                    loading="lazy"
                                    src="/img/projects/p2-2.jpg"
                                    alt="Vista 2"
                                />
                            </figure>
                        </div>
                        <div class="car-ctrl">
                            <button class="arrow left" aria-label="Anterior"
                                >‹</button
                            >
                            <button class="arrow right" aria-label="Siguiente"
                                >›</button
                            >
                            <div class="dots">
                                <i class="dot is-active"></i><i class="dot"></i>
                            </div>
                        </div>
                    </div>
                    <div class="p-meta">
                        <h4>[Proyecto 2]</h4>
                        <p class="prose">[Descripción breve.]</p>
                        <div class="p-tags">
                            <span class="chip">[Tech A]</span><span class="chip"
                                >[Tech B]</span
                            >
                        </div>
                        <div class="p-links">
                            <a class="btn" href="#">Repo</a>
                        </div>
                    </div>
                </article>

                <!-- Project 3 -->
                <article class="project">
                    <div class="carousel">
                        <div class="slides">
                            <figure>
                                <img
                                    loading="lazy"
                                    src="/img/projects/p3-1.jpg"
                                    alt="Vista 1"
                                />
                            </figure>
                        </div>
                    </div>
                    <div class="p-meta">
                        <h4>[Proyecto 3]</h4>
                        <p class="prose">[Descripción breve.]</p>
                        <div class="p-tags">
                            <span class="chip">[Tech X]</span><span class="chip"
                                >[Tech Y]</span
                            >
                        </div>
                        <div class="p-links">
                            <a class="btn" href="#">Live</a>
                        </div>
                    </div>
                </article>
            </div>
        </div>
    </section>
</div>

<style>
    :root {
        --avatar-max: 280px; /* controla ancho en desktop */
    }

    /* Layout principal */
    .layout {
        max-width: 1200px;
        margin: auto;
        display: grid;
        gap: 0;
        grid-template-columns: 360px 1fr;
        height: 100%;
        width: 100%;
        min-height: 0;
        min-width: 0;
        overflow: hidden;
        grid-template-rows: 1fr;
    }
    .layout > * {
        min-width: 0;
        min-height: 0;
    }

    /* Columna izquierda: centro vertical del avatar */
    .col-left {
        align-items: center;
    }
    .avatar-card {
        flex: 1 1 0; /* ocupa el alto restante */
        margin-block: 0;
        align-self: stretch; /* llenar ancho de la columna */
        width: 100%;
        display: flex; /* permite que el hijo copie 100% */
        padding: 0; /* mismo tamaño exacto que el hijo */
        min-height: 0; /* evita overflow del hijo */
    }
    .info-left {
        flex: 0 0 auto; /* chips según contenido */
        min-height: 0;
    }

    /* Cards: definidas como utilidades globales (.card, .pad) */

    /* Avatar: el hijo ocupa EXACTO lo mismo que su padre directo */
    .avatar-wrap {
        width: 100%;
        height: 100%;
    }
    .avatar {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        mask: linear-gradient(
            to bottom,
            rgba(0, 0, 0, 1) 0%,
            rgba(0, 0, 0, 1) 70%,
            rgba(0, 0, 0, 0) 100%
        );
        -webkit-mask: linear-gradient(
            to bottom,
            rgba(0, 0, 0, 1) 0%,
            rgba(0, 0, 0, 1) 70%,
            rgba(0, 0, 0, 0) 100%
        );
    }

    /* Badges eliminados: usamos .chips + .chip */

    /* Columna derecha usa utilidades globales */

    /* Secciones */
    .section {
        /* por defecto, alto según contenido */
        flex: 0 0 auto;
        min-height: 0;
    }
    .section.fill {
        /* solo las secciones con .fill crecen para ocupar el resto */
        flex: 1 1 auto;
        min-height: 0;
    }
    .section > h3 {
        margin: 0;
        font-size: 1.15rem;
    }
    .prose {
        color: var(--muted);
        line-height: 1.55;
    }

    /* La card rellena solo cuando la sección es .fill (ej. Top projects)
       Nota: no forzamos display aquí para no sobrescribir .projects { display: grid } */
    .section.fill > .card {
        flex: 1 1 0;
        min-height: 0;
        overflow: auto;
    }

    /* CTA */
    .cta {
        display: flex;
        gap: var(--gap);
        flex-wrap: wrap;
        margin-top: 0;
        min-width: 0;
    }
    .btn {
        display: inline-flex;
        align-items: center;
        gap: 0;
        padding: 0;
        border-radius: 10px;
        border: 1px solid var(--ring);
        background: rgba(255, 255, 255, 0.04);
        color: var(--ink);
        text-decoration: none;
    }
    .btn:hover {
        background: rgba(255, 255, 255, 0.06);
    }

    /* Chips */
    /* .chips heredará de la utilidad .cluster */
    .chip {
        display: inline-flex;
        align-items: center;
        font-size: 0.78rem;
        font-weight: 500;
        line-height: 1;
        padding: 0.35rem 0.6rem;
        border-radius: 999px;
        border: 1px solid var(--ring);
        color: var(--ink);
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(4px);
        transition:
            background 160ms ease,
            border-color 160ms ease,
            box-shadow 160ms ease,
            transform 160ms ease;
        user-select: none;
    }
    .chip:hover {
        background: rgba(255, 255, 255, 0.08);
        box-shadow:
            0 1px 0 rgba(255, 255, 255, 0.08) inset,
            0 4px 16px rgba(0, 0, 0, 0.25);
        transform: translateY(-1px);
    }
    .chip:active {
        transform: translateY(0);
        box-shadow: 0 0 0 rgba(0, 0, 0, 0);
        background: rgba(255, 255, 255, 0.06);
    }
    .chip:focus-visible {
        outline: 2px solid color-mix(in oklab, var(--ring) 60%, #ffffff);
        outline-offset: 2px;
    }
    .chip.is-active {
        background: rgba(255, 255, 255, 0.12);
        border-color: color-mix(in oklab, var(--ring) 70%, #fff);
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.06) inset;
    }

    /* ================= Projects sin overflows ni huecos ================ */
    .projects {
        display: grid;
        gap: var(--gap);
        grid-template-columns: repeat(var(--proj, 3), minmax(0, 1fr));
        grid-template-rows: 1fr; /* una fila que ocupa toda la altura */
        align-items: stretch;
        justify-items: stretch;
        min-width: 0;
        min-height: 0;
        height: 100%;
        overflow: auto; /* permite ver el contenido si el meta ocupa más */
    }
    .project {
        /* Reset básico: sin layout forzado ni alturas impuestas */
        display: block;
        margin: 0;
        padding: 0;
        min-width: 0;
        min-height: 0;
        height: auto;
        overflow: visible;
    }
    .carousel {
        position: relative;
        border-radius: 12px;
        overflow: hidden;
        background: #0d131d;
        border: 1px solid var(--ring);
        min-width: 0;
        min-height: 0;
        height: 100%;
    }
    .slides {
        display: grid;
        grid-auto-flow: column;
        grid-auto-columns: 100%;
        height: 100%;
        overflow: hidden;
        scrollbar-width: none;
        min-width: 0;
        min-height: 0;
    }
    .slides::-webkit-scrollbar {
        display: none;
    }
    .slides figure,
    .slides video {
        margin: 0;
        width: 100%;
        height: 100%;
    }
    .slides img,
    .slides video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }
    .car-ctrl {
        position: absolute;
        inset: 0;
        pointer-events: none;
    }
    .arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: auto;
        width: 36px;
        height: 36px;
        display: grid;
        place-items: center;
        border: 1px solid var(--ring);
        border-radius: 999px;
        background: rgba(0, 0, 0, 0.35);
        backdrop-filter: blur(4px);
    }
    .arrow.left {
        left: 8px;
    }
    .arrow.right {
        right: 8px;
    }
    .dots {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 6px;
        display: flex;
        gap: var(--gap);
        justify-content: center;
        pointer-events: none;
    }
    .dot {
        width: 8px;
        height: 8px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.35);
    }
    .dot.is-active {
        background: #fff;
    }

    .p-meta {
        display: flex;
        flex-direction: column;
        gap: var(--gap);
        min-width: 0;
        min-height: 0;
        overflow: hidden;
    }
    .p-meta h4 {
        margin: 0;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .p-meta .prose {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        line-height: 1.55;
        max-height: calc(1em * 1.55 * 3);
    }
    .p-tags,
    .p-links {
        display: flex;
        gap: var(--gap);
        flex-wrap: wrap;
        min-width: 0;
    }
    .p-links .btn {
        padding: 0;
    }

    /* ================== Responsivo ================== */
    @media (max-width: 1200px) {
        :root {
            --proj: 2;
        }
    }
    @media (max-width: 720px) {
        :root {
            --proj: 1;
        }
    }

    /* Colapso de layout general en móviles */
    @media (max-width: 900px) {
        .layout {
            grid-template-columns: 1fr;
        }

        /* En móvil, estira horizontal y céntrala. Mantiene ratio 3/4. */
        .avatar-card {
            /* align-self: stretch; */
            width: 100%;
            max-width: 420px;
            margin: 0 auto;
        }
    }
</style>
