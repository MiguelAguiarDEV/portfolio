---
import ProjectItem from "../ProjectItem.astro";
import type { Props as ProjectItemProps } from "../ProjectItem.astro";
import { projects } from "@/data/projects";

const heroChips: { label: string; key: string }[] = [
    { label: "Backend", key: "chip.backend" },
    { label: "Islas Canarias", key: "chip.canary" },
    { label: "Remoto", key: "chip.remote" },
    { label: "Estudiante de informatica", key: "chip.csStudent" },
    { label: "Ingles / Espanol", key: "chip.bilingual" },
];

const featuredProjects: ProjectItemProps[] = projects.slice(0, 3);
---

<div class="layout">
    <aside class="column">
        <div class="avatar-ctn">
            <img
                class="avatar"
                src="/img/foto-yo.png"
                alt="Foto de Miguel Santiesteban"
            />
        </div>

        <div class="card-ctn">
            <div class="card">
                {
                    heroChips.map((chip) => (
                        <span class="chips" data-i18n-key={chip.key}>
                            {chip.label}
                        </span>
                    ))
                }
            </div>
        </div>
    </aside>

    <section class="column">
        <div class="card-ctn">
            <h3 class="card-title" data-i18n-key="about.title">Sobre mi</h3>
            <div class="card">
                <p class="about-description" data-i18n-key="about.description">
                    Soy Miguel Santiesteban, un estudiante de Ingenieria
                    Informatica de 22 anos de las Islas Canarias, Espana. Me
                    especializo en desarrollo backend y disfruto crear proyectos
                    desde cero, resolver problemas complejos y aprender de forma
                    continua.
                </p>
                <div class="btn-ctn">
                    <a
                        class="btn btn--primary"
                        href="/cv/Miguel_Santiesteban_CV.pdf"
                        download
                        data-i18n-key="about.downloadCv"
                    >
                        Descargar CV
                    </a>
                    <span class="cta-rainbow">
                        <a
                            class="cta-rainbow__btn"
                            href="mailto:miguel@example.com?subject=Hello%20%E2%80%94%20Miguel%20Santiesteban"
                            aria-label="Contactar por correo"
                            data-i18n-key="about.contact"
                            data-i18n-attr-aria-label="about.contact.aria"
                        >
                            Contacto
                        </a>
                    </span>
                </div>
            </div>
        </div>

        <div class="card-ctn">
            <h3 class="card-title" data-i18n-key="about.stack">Tecnologias</h3>
            <div class="card">
                <span class="chips">TypeScript</span>
                <span class="chips">Node.js</span>
                <span class="chips">NestJS</span>
                <span class="chips">Prisma</span>
                <span class="chips">MySQL</span>
                <span class="chips">React</span>
                <span class="chips">Docker</span>
                <span class="chips">GraphQL</span>
                <span class="chips">Astro</span>
                <span class="chips">Redis</span>
            </div>
        </div>

        <div class="card-ctn fill">
            <h3 class="card-title" data-i18n-key="about.topProjects">
                Proyectos destacados
            </h3>
            <div class="projects">
                {
                    featuredProjects.map((project) => (
                        <ProjectItem {...project} />
                    ))
                }
            </div>
        </div>
    </section>
</div>

<style>
    /* === Rainbow contact button (con conic-gradient animado) === */
    /* Vars base del snippet */
    :root {
        --conic-gradient: conic-gradient(
            #ff2e2e,
            #ff831e,
            #fcff51,
            #58ff57,
            #575fff,
            #d257ff,
            #ff57e5,
            #ff1556
        );
    }

    /* Contenedor del halo */
    .cta-rainbow {
        position: relative;
        display: inline-block;
        border-radius: 12px;
        padding: 2px; /* grosor del borde arcoiris */
        isolation: isolate;
        overflow: hidden;
        transform-origin: center;
        transition: transform 0.25s ease;
        will-change: transform;
    }

    /* Capa arcoiris animada detras */
    .cta-rainbow::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 180%; /* lado del halo cuadrado */
        aspect-ratio: 1 / 1; /* fuerza a ser cuadrado */
        background: var(--conic-gradient);
        border-radius: 0; /* cuadrado (sin redondeo) */
        z-index: 0;
        filter: saturate(1.1);
        animation: spin 4s linear infinite;
    }

    /* Boton real */
    .cta-rainbow__btn {
        position: relative;
        z-index: 1;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: fit-content; /* ajusta tamano segun diseno */
        min-height: fit-content;
        padding: 0 0;
        border-radius: 10px;
        background: rgb(41, 73, 80, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.18);
        color: #fff;
        text-decoration: none;
        font-weight: 600;
        letter-spacing: 0.2px;
        box-shadow: 0 0.6rem 1.2rem rgba(0, 0, 0, 0.35);
        backdrop-filter: blur(4px) saturate(1.05);
        transition:
            transform 0.25s ease,
            box-shadow 0.25s ease;

        gap: 0.35rem;
        font-size: 0.9rem;
        font-weight: 600;
        line-height: 1;
        padding: calc(0.55rem - 2px) calc(0.85rem - 2px);
        text-decoration: none;
        text-transform: uppercase;
    }

    /* Hover: escalar el conjunto arcoiris + boton */
    .cta-rainbow:hover {
        transform: scale(1.06);
    }

    /* Hover: refuerzo suave sobre el boton */
    .cta-rainbow__btn:hover {
        transform: scale(1.04);
        box-shadow: 0 0.9rem 1.6rem rgba(0, 0, 0, 0.45);
    }

    /* Reusa la animacion del snippet */
    @keyframes spin {
        from {
            transform: translate(-50%, -50%) rotate(0deg);
        }
        to {
            transform: translate(-50%, -50%) rotate(360deg);
        }
    }

    /* Respeta usuarios con reduced motion */
    @media (prefers-reduced-motion: reduce) {
        .cta-rainbow::before {
            animation: none;
        }
        .cta-rainbow__btn {
            transition: none;
        }
    }

    /* ============================ */
    /* Responsive Breakpoints       */
    /* ============================ */

    /* Desktop Grande: >= 1200px */
    @media (min-width: 1200px) {
        .about-description {
            font-size: 1rem;
        }
    }

    /* Tablet Grande: 900px - 1199px */
    @media (min-width: 900px) and (max-width: 1199px) {
        .about-description {
            font-size: 0.95rem;
        }
    }

    /* Tablet: 640px - 899px */
    @media (min-width: 640px) and (max-width: 899px) {
        .about-description {
            font-size: 0.9rem;
        }
    }

    /* Mobile: < 640px */
    @media (max-width: 639px) {
        .about-description {
            font-size: 0.7rem;
        }
    }
</style>
