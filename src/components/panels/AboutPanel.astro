---
import ContactModal from "../ContactModal.astro";
import { projects } from "@/data/projects";
import Button from "@/components/ui/Button.astro";
import Chip from "@/components/ui/Chip.astro";
import Card from "@/components/ui/Card.astro";
import Container from "@/components/ui/Container.astro";
import ProjectGrid from "@/components/ui/ProjectGrid.astro";
import ProjectCard from "@/components/ui/ProjectCard.astro";
import Section from "@/components/ui/Section.astro";
import SectionTitle from "@/components/ui/SectionTitle.astro";

const heroChips: { label: string; key: string }[] = [
    { label: "Backend", key: "chip.backend" },
    { label: "Islas Canarias", key: "chip.canary" },
    { label: "Remoto", key: "chip.remote" },
    { label: "Estudiante de informatica", key: "chip.csStudent" },
    { label: "Ingles / Espanol", key: "chip.bilingual" },
];

const featuredProjects = projects.slice(0, 3);
---

<div class="layout">
    <Container as="aside" aria-label="Información personal">
        <div class="avatar-ctn">
            <img
                class="avatar"
                src="/img/foto-yo.png"
                alt="Foto de Miguel Santiesteban"
            />
        </div>

        <Card>
            <h2 class="visually-hidden">Especialidades</h2>
            <div
                role="list"
                aria-label="Especialidades y ubicación"
                style="display: contents;"
            >
                {
                    heroChips.map((chip) => (
                        <Chip data-i18n-key={chip.key} role="listitem">
                            {chip.label}
                        </Chip>
                    ))
                }
            </div>
        </Card>
    </Container>

    <Container>
        <Section gap="xs" aria-labelledby="about-heading">
            <SectionTitle id="about-heading" data-i18n-key="about.title">
                Sobre mi
            </SectionTitle>
            <Card>
                <p class="about-description" data-i18n-key="about.description">
                    Soy Miguel Santiesteban, un estudiante de Ingenieria
                    Informatica de 22 anos de las Islas Canarias, Espana. Me
                    especializo en desarrollo backend y disfruto crear proyectos
                    desde cero, resolver problemas complejos y aprender de forma
                    continua.
                </p>
                <div class="btn-ctn">
                    <Button
                        href="/cv-miguel-santiesteban-aguiar-esp.pdf"
                        download
                        data-i18n-key="about.downloadCv"
                        data-i18n-attr-href="about.downloadCv.href"
                    >
                        Descargar CV
                    </Button>
                    <Button
                        variant="rainbow"
                        type="button"
                        data-contact-modal-trigger
                        aria-label="Abrir formulario de contacto"
                        data-i18n-key="about.contact"
                        data-i18n-attr-aria-label="contact.modal.open"
                    >
                        Contacto
                    </Button>
                </div>
            </Card>
        </Section>

        <Section gap="xs" aria-labelledby="stack-heading">
            <SectionTitle id="stack-heading" data-i18n-key="about.stack">
                Tecnologias
            </SectionTitle>
            <Card>
                <div
                    role="list"
                    aria-label="Tecnologías que manejo"
                    style="display: contents;"
                >
                    <Chip role="listitem">TypeScript</Chip>
                    <Chip role="listitem">Node.js</Chip>
                    <Chip role="listitem">NestJS</Chip>
                    <Chip role="listitem">Prisma</Chip>
                    <Chip role="listitem">MySQL</Chip>
                    <Chip role="listitem">React</Chip>
                    <Chip role="listitem">Docker</Chip>
                    <Chip role="listitem">GraphQL</Chip>
                    <Chip role="listitem">Astro</Chip>
                    <Chip role="listitem">Redis</Chip>
                </div>
            </Card>
        </Section>

        <Section gap="xs" fill aria-labelledby="featured-heading">
            <SectionTitle
                id="featured-heading"
                data-i18n-key="about.topProjects"
            >
                Proyectos destacados
            </SectionTitle>
            <ProjectGrid>
                {
                    featuredProjects.map((project) => (
                        <ProjectCard {...project} />
                    ))
                }
            </ProjectGrid>
        </Section>
    </Container>
</div>

<ContactModal />

<style>
    .about-description {
        padding-left: var(--space-xs);
        line-height: 1.2;
    }

    .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }

    .btn-ctn {
        display: flex;
        justify-content: center;
        align-items: end;
        gap: var(--space-sm);
        padding: 0;
    }

    .avatar-ctn {
        display: flex;
        justify-content: center;
        align-items: end;
        flex: 1 1 0;
        min-height: 0;
        padding: 0;
        overflow: hidden;
    }

    .avatar {
        width: auto;
        height: 100%;
        max-height: 100%;
        object-fit: contain;
        padding: 0;
        -webkit-mask-image: linear-gradient(
            to bottom,
            #000 0%,
            #000 75%,
            transparent 100%
        );
        mask-image: linear-gradient(
            to bottom,
            #000 0%,
            #000 75%,
            transparent 100%
        );
    }

    /* Responsive */
    @media (min-width: 1200px) {
        .about-description {
            font-size: 1rem;
        }
    }

    @media (min-width: 900px) and (max-width: 1199px) {
        .about-description {
            font-size: 0.95rem;
        }
    }

    @media (min-width: 640px) and (max-width: 899px) {
        .about-description {
            font-size: 0.9rem;
        }
    }

    @media (max-width: 639px) {
        .about-description {
            font-size: 0.7rem;
        }
    }
</style>
