---
export interface Props {
    id: string;
    title: string;
    lead?: string;
    initial?: boolean;
    background?: string;
}

const { id, title, lead, initial = false, background } = Astro.props;
const headingId = `h-${id}`;
const ariaHidden = initial ? "false" : "true";
const panelStyle = background ? `--bg: ${background}` : undefined;
---

<div class="panel" id={id} aria-hidden={ariaHidden} style={panelStyle}>
    <div class="bg"></div>
    <section aria-labelledby={headingId}>
        <h1
            id={headingId}
            class="visually-hidden"
            data-i18n-key={`panel.${id}.title`}
        >
            {title}
        </h1>
        <slot />
    </section>
</div>

<style>
    .panel {
        position: absolute;
        inset: 0;
        z-index: 0;
        display: grid;
        grid-template-rows: 1fr;
        grid-template-columns: 1fr;
        place-items: center;
        overflow: visible;
    }

    .panel > .bg {
        position: absolute;
        inset: 0;
        background: var(--bg, #111);
        pointer-events: none;
        padding: 0;
    }

    .panel > section {
        position: relative;
        z-index: 1;
        width: min(1200px, 84vw);
        max-width: 100%;
        margin-top: calc(
            var(--nav-margin-top) + var(--nav-h) + var(--nav-panel-gap)
        );
        margin-bottom: var(--edge-margin);
        height: calc(
            100vh - var(--nav-margin-top) - var(--nav-h) - var(--nav-panel-gap) -
                var(--edge-margin)
        );
        max-height: calc(
            100vh - var(--nav-margin-top) - var(--nav-h) - var(--nav-panel-gap) -
                var(--edge-margin)
        );
        min-height: calc(
            100vh - var(--nav-margin-top) - var(--nav-h) - var(--nav-panel-gap) -
                var(--edge-margin)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius);
        overflow: visible;
        box-sizing: border-box;
    }

    .panel > section > * {
        width: 100%;
        height: 100%;
        max-height: 100%;
        overflow: hidden;
        padding: 0;
    }

    .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }

    .panel.entering {
        animation: reveal var(--wipe-ms) ease-out both;
    }

    @keyframes reveal {
        0% {
            clip-path: inset(0 100% 0 0 round 0);
        }

        100% {
            clip-path: inset(0 0 0 0 round 0);
        }
    }

    @media (max-width: 1000px) {
        .panel > section {
            width: min(960px, 92vw);
            max-width: 100%;
            height: min(85vh, 85svh);
            max-height: min(85vh, 85svh);
            min-height: min(85vh, 85svh);
            padding-top: clamp(16px, 2.5vh, 24px);
        }
    }
</style>
