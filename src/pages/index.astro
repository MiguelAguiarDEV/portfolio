---
import FloatingNav from "@/components/FloatingNav.astro";
import Panel from "@/components/Panel.astro";
import CardsGrid from "@/components/GridCard.astro";
import AboutPanel from "@/components/panels/AboutPanel.astro";
import ProjectsPanel from "@/components/panels/ProjectsPanel.astro";
import type { Props as ProjectItemProps } from "@/components/ProjectItem.astro";
import Analytics from "@vercel/analytics/astro";
import "@/styles/global.css";

type PanelCard = {
    title: string;
    description: string;
};

type PanelData = {
    id: string;
    label: string;
    title: string;
    lead?: string;
    background: string;
    cards?: PanelCard[];
};

const panels: PanelData[] = [
    {
        id: "about",
        label: "Sobre mí",
        title: "Sobre mí",
        background: "linear-gradient(135deg, #0b3a36, #0b2a3a 70%)",
    },
    {
        id: "work",
        label: "Proyectos",
        title: "Proyectos",
        background: "linear-gradient(135deg, #2a143a, #0f1020 70%)",
    },
    {
        id: "contact",
        label: "Contacto",
        title: "Contacto",
        background: "linear-gradient(135deg, #3a1a1a, #101010 70%)",
        cards: [
            { title: "Email", description: "miguel@example.com" },
            { title: "GitHub", description: "@MiguelAguiarDev" },
            { title: "LinkedIn", description: "/in/MiguelAguiarDev" },
        ],
    },
];

// Datos para ProjectsPanel
const projects: ProjectItemProps[] = [
    {
        name: "[Nombre del proyecto]",
        description: "[Descripción breve. Qué resuelve, rol, impacto.]",
        slides: [
            { kind: "image", src: "/img/projects/p1-1.jpg", alt: "Vista 1" },
            { kind: "image", src: "/img/projects/p1-2.jpg", alt: "Vista 2" },
            {
                kind: "video",
                poster: "/img/projects/p1-cover.jpg",
                sources: [
                    { src: "/video/projects/p1-demo.mp4", type: "video/mp4" },
                ],
            },
        ],
        stack: ["[Stack 1]", "[Stack 2]", "[Stack 3]"],
        liveUrl: "#",
        repoUrl: "#",
    },
    {
        name: "[Proyecto 2]",
        description: "[Descripción breve.]",
        slides: [
            { kind: "image", src: "/img/projects/p2-1.jpg", alt: "Vista 1" },
            { kind: "image", src: "/img/projects/p2-2.jpg", alt: "Vista 2" },
        ],
        stack: ["[Tech A]", "[Tech B]"],
        repoUrl: "#",
    },
    {
        name: "[Proyecto 3]",
        description: "[Descripción breve.]",
        slides: [
            { kind: "image", src: "/img/projects/p3-1.jpg", alt: "Vista 1" },
        ],
        stack: ["[Tech X]", "[Tech Y]"],
        liveUrl: "#",
    },
];

const navItems = panels.map(({ id, label }) => ({ id, label }));
---

<!doctype html>
<html lang="es" class="dark">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <link
            rel="icon"
            href="/favicon-dark.svg"
            media="(prefers-color-scheme: light)"
        />
        <link
            rel="icon"
            href="/favicon-light.svg"
            media="(prefers-color-scheme: dark)"
        />
        <title>MiguelAguiarDev</title>
    </head>
    <body>
        <FloatingNav items={navItems} />
        <main id="stage" role="main" aria-live="polite">
            {
                panels.map((panel, index) => (
                    <Panel
                        id={panel.id}
                        title={panel.title}
                        lead={panel.lead}
                        initial={index === 0}
                        background={panel.background}
                        hideHeading={panel.id === "about"}
                    >
                        {panel.id === "about" ? (
                            <AboutPanel />
                        ) : panel.id === "work" ? (
                            <ProjectsPanel
                                title="Top projects"
                                projects={projects}
                            />
                        ) : (
                            panel.cards && <CardsGrid items={panel.cards} />
                        )}
                    </Panel>
                ))
            }
        </main>
        <Analytics />
        <script type="module" src="/scripts/stage-navigation.js"></script>
    </body>
</html>

<style>
    #stage {
        position: relative;
        width: 100vw;
        height: 100dvh;
        isolation: isolate;
        background: radial-gradient(
            120vmax 120vmax at 10% 10%,
            #17181c,
            #0f0f10 60%
        );
    }
</style>
