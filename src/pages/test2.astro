<!doctype html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Multi-secciones con wipe (clip-path)</title>
        <style>
            :root {
                --dur: 700ms;
                --ease: cubic-bezier(0.22, 0.61, 0.36, 1);
            }
            html,
            body {
                height: 100%;
            }
            body {
                margin: 0;
                background: #111;
                color: #fff;
                font-family: system-ui, sans-serif;
            }
            .shell {
                height: 100dvh;
                display: grid;
                grid-template-rows: auto 1fr;
            }
            /* navbar */
            .nav {
                display: flex;
                gap: 0.5rem;
                padding: 0.75rem;
                justify-content: center;
                position: relative;
                z-index: 10;
            }
            .nav button {
                padding: 0.5rem 0.9rem;
                border-radius: 999px;
                border: 0;
                cursor: pointer;
                background: #fff1;
                color: #fff;
                backdrop-filter: blur(8px) saturate(140%);
                transition: background 0.2s;
            }
            .nav button[aria-current="page"] {
                background: #fff3;
            }
            .stage {
                position: relative;
                overflow: hidden;
                border-radius: 18px;
                margin: 0 0.75rem 0.75rem;
                box-shadow: 0 8px 30px #0008;
            }
            /* Secciones apiladas y recortadas por clip-path */
            .section {
                position: absolute;
                inset: 0;
                overflow: hidden;
                /* empieza totalmente oculto: recorte a 100% del lado derecho */
                clip-path: inset(0 100% 0 0 round 24px);
                transition: clip-path var(--dur) var(--ease);
                will-change: clip-path;
            }
            .section.is-active {
                clip-path: inset(0 0 0 0 round 24px);
                z-index: 1;
            }
            /* durante salida, se cierra hacia la derecha */
            .section.hiding-right {
                clip-path: inset(0 0 0 100% round 24px);
            }

            /* Colores de demo */
            .s1 {
                background: radial-gradient(
                    120vmax 120vmax at 20% 20%,
                    #1e293b,
                    #0b1020
                );
            }
            .s2 {
                background: radial-gradient(
                    120vmax 120vmax at 80% 20%,
                    #064e3b,
                    #051a14
                );
            }
            .s3 {
                background: radial-gradient(
                    120vmax 120vmax at 20% 80%,
                    #7c2d12,
                    #1a0b05
                );
            }
            .s4 {
                background: radial-gradient(
                    120vmax 120vmax at 80% 80%,
                    #3b0764,
                    #0f0620
                );
            }

            .content {
                height: 100%;
                display: grid;
                place-items: center;
                text-align: center;
            }
            .content h1 {
                font-size: clamp(24px, 4vw, 48px);
                margin: 0 0 0.25rem;
            }
            .content p {
                opacity: 0.8;
                margin: 0;
            }
        </style>
    </head>
    <body>
        <div class="shell">
            <nav class="nav" id="nav">
                <button data-target="s1" aria-current="page">Sección 1</button>
                <button data-target="s2">Sección 2</button>
                <button data-target="s3">Sección 3</button>
                <button data-target="s4">Sección 4</button>
            </nav>

            <div class="stage" id="stage">
                <section class="section s1 is-active" id="s1">
                    <div class="content">
                        <div><h1>Sección 1</h1><p>Wipe con clip-path</p></div>
                    </div>
                </section>
                <section class="section s2" id="s2">
                    <div class="content">
                        <div><h1>Sección 2</h1><p>Mismo efecto</p></div>
                    </div>
                </section>
                <section class="section s3" id="s3">
                    <div class="content">
                        <div><h1>Sección 3</h1><p>Transición limpia</p></div>
                    </div>
                </section>
                <section class="section s4" id="s4">
                    <div class="content">
                        <div><h1>Sección 4</h1><p>Sin pseudo-elementos</p></div>
                    </div>
                </section>
            </div>
        </div>

        <script>
            const nav = document.getElementById("nav");
            const buttons = [...nav.querySelectorAll("button")];
            const sections = new Map(
                [...document.querySelectorAll(".section")].map((s) => [
                    s.id,
                    s,
                ]),
            );
            let current = document.querySelector(".section.is-active");
            let lock = false;

            function go(targetId) {
                if (lock) return;
                const next = sections.get(targetId);
                if (!next || next === current) return;

                lock = true;
                // preparar estados iniciales
                next.classList.remove("is-active"); // asegura que parte desde oculto (clip a 100%)
                next.style.zIndex = 2;
                // reflow para fijar el estado inicial antes de transicionar
                next.getBoundingClientRect();

                // lanzar transiciones: entra "next", sale "current"
                next.classList.add("is-active"); // 100% → 0%  (revela)
                current.classList.add("hiding-right"); // 0% → 100%  (cierra)

                const onDone = (e) => {
                    if (e.propertyName !== "clip-path") return;
                    next.removeEventListener("transitionend", onDone);
                    // limpiar estados
                    current.classList.remove("is-active", "hiding-right");
                    next.style.zIndex = "";
                    current = next;
                    lock = false;
                };
                next.addEventListener("transitionend", onDone);

                // actualizar navbar
                buttons.forEach((b) =>
                    b.setAttribute(
                        "aria-current",
                        b.dataset.target === targetId ? "page" : "false",
                    ),
                );
            }

            nav.addEventListener("click", (e) => {
                const btn = e.target.closest("button[data-target]");
                if (!btn) return;
                go(btn.dataset.target);
            });

            // opcional: teclado ← →
            window.addEventListener("keydown", (e) => {
                if (!["ArrowLeft", "ArrowRight"].includes(e.key) || lock)
                    return;
                const order = buttons.map((b) => b.dataset.target);
                const i = order.indexOf(current.id);
                const next =
                    e.key === "ArrowRight"
                        ? order[(i + 1) % order.length]
                        : order[(i - 1 + order.length) % order.length];
                go(next);
            });
        </script>
    </body>
</html>
